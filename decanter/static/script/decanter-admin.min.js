var DC,_base,_base1,_ref,_ref1,_ref2,_ref3,__bind=function(e,t){return function(){return e.apply(t,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};DC=window.DC=(_ref=window.DC)!=null?_ref:{},DC.Application=function(){function e(e){e==null&&(e={}),this.protocol=e.protocol,this.protocol||(this.protocol=window.location.protocol),this.apiHost=e.apiHost||window.location.host,this.apiHost&&(this.crossDomain=this.apiHost!==window.location.host),this.crossDomain||(this.crossDomain=!1),this.apiPathSegment=e.apiPathSegment,this.apiRoot=""+this.protocol+"//"+this.apiHost,this.apiPathSegment&&(this.apiRoot=""+this.apiRoot+"/"+this.apiPathSegment),this.adminPath=e.adminPath||"",this.adminPath&&(this.adminPath=this.adminPath.replace("/",""),this.adminPath="/"+this.adminPath)}return e.init=function(e){var t;return t=DC.app=new this(e),t},e}(),DC.Navigation=function(){function e(e){this.onClick=__bind(this.onClick,this);var t,n,r,i,s,o,u,a;t=window.location.pathname,e==null&&(e={}),(u=e.targets)==null&&(e.targets=[]),a=e.targets;for(s=0,o=a.length;s<o;s++)i=a[s],n=jQuery(i.id),r={el:n,link:i.link},r.link===t&&this.activate(r),this.register(r),this[i.id]=r}return e.init=function(e){var t;return t=DC.nav=new this(e),t},e.prototype.activate=function(e){return e.el.parent().addClass("active")},e.prototype.register=function(e){return e.el.click(this.onClick)},e.prototype.onClick=function(e){var t;return e.preventDefault(),t=this["#"+e.target.id],window.location=t.link},e}(),DC.Page=function(){function e(e){e==null&&(e={})}return e.init=function(e){var t;return t=DC.page=new this(e),t.render(),t},e.prototype.render=function(){return ko.applyBindings(this),this},e}(),(_ref1=DC.admin)==null&&(DC.admin={}),(_ref2=(_base=DC.admin).models)==null&&(_base.models={}),(_ref3=(_base1=DC.admin).forms)==null&&(_base1.forms={}),DC.Admin=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t}(DC.Application),DC.AdminNav=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t}(DC.Navigation),DC.admin.forms.Post=function(e){function t(){return this.defaultSlug=__bind(this.defaultSlug,this),t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.init=function(e){var t,n,r,i,s;return e==null&&(e={}),this.model=e.model,this.model||(this.endpoint=""+DC.app.apiRoot+"/post/"),this.endpoint||(this.endpoint=""+DC.app.apiRoot+"/post/"+this.model.id()),this.field({name:"title",label:"Title",value:((t=this.model)!=null?t.title:void 0)||void 0,validators:[new kohelpers.validate.Required({name:"Title"})]}),this.field({name:"slug",label:"Slug",value:((n=this.model)!=null?n.slug:void 0)||void 0,validators:[new kohelpers.validate.Required({name:"Slug"})]}),this.field({name:"content",label:"Content",value:((r=this.model)!=null?r.content:void 0)||void 0,validators:[new kohelpers.validate.Required({name:"Content"})]}),this.field({name:"id",value:((i=this.model)!=null?i.id:void 0)||void 0,validators:[]}),this.field({name:"author_id",value:((s=this.model)!=null?s.author_id:void 0)||void 0,validators:[]}),this.title.subscribe(this.defaultSlug)},t.prototype.defaultSlug=function(){if(!this.slug())return this.slug(this.title().replace(" ","-").toLowerCase())},t}(kohelpers.form.Form),DC.admin.models.Post=function(e){function t(e){t.__super__.constructor.call(this,e),this.editLink=ko.computed(this.editLink,this),this.activeFieldName=ko.computed(this.activeFieldName,this),this.endpoint=""+DC.app.apiRoot+"/post/"+this.id()}return __extends(t,e),t.endpoint=function(e){return""+DC.app.apiRoot+"/post/"+e},t.prototype.editLink=function(){return""+DC.app.adminPath+"/posts/edit/"+this.id()},t.prototype.activeFieldName=function(){return"post-"+this.id()+"-active"},t}(kohelpers.model.Model),DC.admin.models.PostContainer=function(e){function t(e){t.__super__.constructor.call(this,e),this.endpoint=""+DC.app.apiRoot+"/post/"}return __extends(t,e),t.prototype.model=DC.admin.models.Post,t}(kohelpers.model.ModelContainer),DC.admin.models.User=function(e){function t(e){t.__super__.constructor.call(this,e),this.activeFieldName=ko.computed(this.activeFieldName,this),this.endpoint=""+DC.app.apiRoot+"/user/"+this.username(),this.role_names=ko.computed(this.roleNames,this)}return __extends(t,e),t.endpoint=function(e){return""+DC.app.apiRoot+"/user/"+e},t.prototype.activeFieldName=function(){return"post-"+this.id()+"-active"},t.prototype.roleNames=function(){var e,t;return t=[],e=function(e){return t.push(e.name())},this.roles().forEach(e),t.join(",")},t}(kohelpers.model.Model),DC.admin.models.UserContainer=function(e){function t(e){t.__super__.constructor.call(this,e),this.endpoint=""+DC.app.apiRoot+"/user/"}return __extends(t,e),t.prototype.model=DC.admin.models.User,t}(kohelpers.model.ModelContainer),DC.admin.models.Role=function(e){function t(e){t.__super__.constructor.call(this,e),this.endpoint=""+DC.app.apiRoot+"/role/"+this.id()}return __extends(t,e),t.endpoint=function(e){return""+DC.app.apiRoot+"/role/"+id},t}(kohelpers.model.Model),DC.admin.models.RoleContainer=function(e){function t(e){t.__super__.constructor.call(this,e),this.endpoint=""+DC.app.apiRoot+"/role/"}return __extends(t,e),t.prototype.model=DC.admin.models.Role,t}(kohelpers.model.ModelContainer),DC.admin.PostsPage=function(e){function t(e){this.posts=new DC.admin.models.PostContainer,this.posts.load()}return __extends(t,e),t.prototype.newPost=function(e,t){return t.preventDefault(),window.location=""+DC.app.adminPath+"/posts/create"},t}(DC.Page),DC.admin.UsersPage=function(e){function t(e){this.users=new DC.admin.models.UserContainer,this.users.load()}return __extends(t,e),t}(DC.Page),DC.admin.RolesPage=function(e){function t(e){this.groups=new DC.admin.models.RoleContainer,this.groups.load()}return __extends(t,e),t}(DC.Page),DC.admin.PostCreatePage=function(e){function t(e){this.onSave=__bind(this.onSave,this),this.form=new DC.admin.forms.Post,this.form.saved.add(this.onSave)}return __extends(t,e),t.prototype.onSave=function(){return this.back()},t.prototype.cancel=function(){return this.back()},t.prototype.back=function(){return window.location=""+DC.app.adminPath+"/posts"},t}(DC.Page),DC.admin.PostEditPage=function(e){function t(e){this.onSave=__bind(this.onSave,this),e==null&&(e={}),this.post=new DC.admin.models.Post({id:e.postId,author_id:void 0,title:void 0,slug:void 0,content:void 0,active:!1}),this.getPost(e.postId),this.form=new DC.admin.forms.Post({model:this.post,method:"PUT"}),this.form.saved.add(this.onSave)}return __extends(t,e),t.prototype.getPost=function(e){var t,n,r,i=this;return n=DC.admin.models.Post.endpoint(e),r={},t=function(){return jQuery.ajax({context:i,mimeType:"application/json",contentType:"application/json",error:i.getPostError,headers:r,success:i.getPostSuccess,type:"GET",url:n,xhrFields:{withCredentials:!0}})},t()},t.prototype.getPostSuccess=function(e,t,n){var r;return r=JSON.parse(n.responseText),this.post.update(r)},t.prototype.getPostError=function(e,t,n){},t.prototype.onSave=function(){return this.back()},t.prototype.cancel=function(){return this.back()},t.prototype.back=function(){return window.location=""+DC.app.adminPath+"/posts"},t}(DC.Page);